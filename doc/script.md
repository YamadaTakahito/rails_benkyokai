# Railsの設計思想

- railsとはフレームワークの一種である

  - フレームワークとはカレー粉みたいなものである
  - プログラミングというには「[再利用](https://ja.wikipedia.org/wiki/%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E5%86%8D%E5%88%A9%E7%94%A8)」という重要な概念があり、誰かが作ったものは「使い方をしっかりと理解していれば」、簡単に誰でも再利用できるということである
  - カレー粉においても同様である。もしカレー粉がなかったら、一般人は色々なスパイスを調合してカレーを作らないといけない。もしそうなら、カレーは一般家庭に普及していなかった。でも、企業がいい感じにスパイスを調合してカレー粉を作り、ただお湯で溶かせばカレーを作れるようにしてくれた。これによって、より多くの人にカレーが普及した
  - 同様に、どこかの天才がいい感じにプログラミングを作ってくれ、それを公開してくれたことで、素人でもそれなりの製品が作れるようになった。そのどこかの天才が作ってくれたいい感じのものをフレームワークとよぶ。
  - 例えばReactはJavaScriptのフレームワーク、RailsはRubyのフレームワーク、Djangoはpythonのフレームワーク、WordPressはPHPのフレームワークである。
  - フレームワークを作る際に大事なのは「使い方をしっかりと理解する」こと。カレー粉も説明書を読まず、自分のアドリブで電子レンジにいれてもカレーはできない。
  - 多くのエンジニアが、「本家のドキュメントをしっかりと読め」と行っているのは、「フレームワークを作った本人が書いた説明書をしっかりと理解しろ」ということ
  - あなたも何か作ったら、他の人のためにちゃんとドキュメントを書きましょう。これはマナーです。

- なんのプログラミング言語を使うかは重要ではない。自分が何をしたいかが先で、それを実現するために結果的にプログラミング言語は選ばれるのである。

  - railsの主な設計思想を2つあげると[1]

    1. プログラマーの幸福度の最適化
    2. 設定より規約

  - 簡単にいうと、スピードとかパフォーマンスとか細かいことはどうでもいいから、とにかく開発者が楽しくなるような言語にして、開発者の生産性をあげてくれるような言語

  - 個人的には短時間でスピーディーに開発ができるが、サービスが大きくなるに連れてパフォーマンスが落ちていき、使いにくくなる

  - だからスタートアップのサービス（短時間でそれなりのサービスを作りたい）やハッカソンなどで使うのに適していると思う

  - ただrailsを使うのではなくて、なんでrailsを使うのかが大切

- どのようにrailsが使われていたか

  - twitterの例をあげる
  - twitterは、サービスができた2006~2011年くらいまではrailsを使っていた。しかし、その後Javaに書き換えた
  - 創業当初は時間もなく、ideaをパクられる可能性もあるので、なる早で作りたかったのだろう。だからrailsを採用したに違いない
  - しかし、userが増えてくるに連れてパフォーマンスが落ち、どんどん使いにくくなってきたのでjavaに移行したのだろう
  - 例えばrailsとjavaで、同じ処理を行うと0.01s,Javaの方が早いとする。創業初期のuserが100人の頃は100 x0.01s=1sくらいの差だが、100万人を超えると1000000x0.01 = 10000sとなる。さすがにこれは辛い

# RubyはObject指向

- asfdas

  ```ruby
  ssadf
  ```

# なぜサーバーを立てるか

## 理論

- 例えばあだ名を返すrubyプログラムを書いてみるとする。以下のようにして実行する

  `sample/arima.rb`

  ```bash
  ruby sample/arima.rb 山田
  ```

- 例えば、100万人のuserに対してあだ名を作ってあげようとすると、100万回上のやつを実行するのは不可能。よってそれぞれのUserが特定のURLにアクセスして、あだ名を返す仕組みを作ればいい

- <http://localhost:3000/adana/なまえ>にアクセスして見よう

- `config/routes.rb`でどのURLに飛んだら、どのコントローラーにアクセスするか決定する。今回の場合は<http://localhost:3000/adana/なまえ>にアクセスすると、`app/controller/application_controller.rb`の`adana`メソッドが実行される

`config/routes.rb`

```ruby
  get '/adana/:name', to: 'application#adana'
```

- あだ名を生成し、`@adana`という変数に入れる。`render template: "adana/index"`によって、`app/views/adana/index.html.erb`の規則にしたがったhtmlを表示する。基本的に表示するときは@で始まる変数でないといけない

`app/controller/application.rb`

```ruby
def adana
  after = ["ぽん"]
  before = ["T-"]

  @adana = before[Random.rand(0..before.length)] + params[:name] +after[Random.rand(0..after.length)]
  render template: "adana/index"
end
```

- `@adana`という変数をh1タグで表示する

`app/views/adana/index.html.erb`

```html
<h1><%= @adana %></h1>
```

## 演習

- `/konitiwa/<なまえ>`とアクセスすると、`こんにちは<なまえ>さん`と表示されるアプリを作って見よう

# Databaseについて

## Dataの永続化？

- Dataの[永続化](https://ja.wikipedia.org/wiki/%E6%B0%B8%E7%B6%9A%E6%80%A7)とはざっくりいうとどのようにデータを残すか？である。

- SDカードでもURBメモリでもいいのだが、よく用いられるのはDatabaseというものである。[Postico](https://eggerapps.at/postico/)で見てみるとわかる通り、Excel シートみたいなものである。

# ref

- <http://postd.cc/rails-doctrine/>
